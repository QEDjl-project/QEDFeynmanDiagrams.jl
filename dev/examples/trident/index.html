<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Trident · QEDFeynmanDiagrams.jl</title><meta name="title" content="Trident · QEDFeynmanDiagrams.jl"/><meta property="og:title" content="Trident · QEDFeynmanDiagrams.jl"/><meta property="twitter:title" content="Trident · QEDFeynmanDiagrams.jl"/><meta name="description" content="Documentation for QEDFeynmanDiagrams.jl."/><meta property="og:description" content="Documentation for QEDFeynmanDiagrams.jl."/><meta property="twitter:description" content="Documentation for QEDFeynmanDiagrams.jl."/><meta property="og:url" content="https://QEDjl-project.github.io/QEDFeynmanDiagrams.jl/examples/trident/"/><meta property="twitter:url" content="https://QEDjl-project.github.io/QEDFeynmanDiagrams.jl/examples/trident/"/><link rel="canonical" href="https://QEDjl-project.github.io/QEDFeynmanDiagrams.jl/examples/trident/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">QEDFeynmanDiagrams.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">QEDFeynmanDiagrams.jl</a></li><li><a class="tocitem" href="../../manual/">Manual</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Trident</a></li><li><a class="tocitem" href="../compton/">Compton</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/public/">Public</a></li><li><a class="tocitem" href="../../lib/internal/">Internal</a></li></ul></li><li><a class="tocitem" href="../../contribution/">Contribution</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Trident</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Trident</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QEDFeynmanDiagrams/QEDFeynmanDiagrams.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QEDFeynmanDiagrams/QEDFeynmanDiagrams.jl/blob/dev/docs/src/examples/trident.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="n-Pair-Trident-Scattering-Process"><a class="docs-heading-anchor" href="#n-Pair-Trident-Scattering-Process">n-Pair Trident Scattering Process</a><a id="n-Pair-Trident-Scattering-Process-1"></a><a class="docs-heading-anchor-permalink" href="#n-Pair-Trident-Scattering-Process" title="Permalink"></a></h1><p>In this file, we set up an n-pair trident scattering process. A trident process looks like <span>$k e^- \to e^- (e^- e^+)^n$</span>.</p><p>You can download this file as a <a href="../trident.ipynb">jupyter notebook</a>.</p><pre><code class="language-julia hljs">using QEDFeynmanDiagrams</code></pre><p>We need some of the packages of the <a href="https://github.com/QEDjl-project">QEDjl-project</a> for base functionality and the <code>ScatteringProcess</code> type.</p><pre><code class="language-julia hljs">using QEDcore
using QEDprocesses</code></pre><p>Let&#39;s decide how many pairs our trident should produce:</p><pre><code class="language-julia hljs">n = 2;</code></pre><p>Now we setup the scattering process accordingly. We only consider a single spin/polarization combination here. For an example with many spin and polarization combinations, refer to the <a href="../compton/">n-photon Compton example</a></p><pre><code class="language-julia hljs">proc = ScatteringProcess(
    (Electron(), Photon()),                                                         # incoming particles
    (Electron(), ntuple(_ -&gt; Electron(), n)..., ntuple(_ -&gt; Positron(), n)...),     # outgoing particles
    (SpinUp(), PolX()),                                                             # incoming particle spin/pols
    (SpinUp(), ntuple(_ -&gt; SpinUp(), 2 * n)...),                                    # outgoing particle spin/pols
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">generic QED process
    incoming: electron (spin up), photon (x-polarized)
    outgoing: electron (spin up), electron (spin up), electron (spin up), positron (spin up), positron (spin up)
</code></pre><p>The <a href="../../lib/public/#QEDFeynmanDiagrams.feynman_diagrams"><code>feynman_diagrams</code></a> function returns an iterator for all possible Feynman diagrams for this scattering process. With its <code>length</code> overload, we can check how many diagrams there are.</p><pre><code class="language-julia hljs">length(feynman_diagrams(proc))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">252</code></pre><p>Next, we can generate the DAG representing the computation for our scattering process&#39; squared matrix element. This uses <code>ComputableDAGs.jl</code>.</p><pre><code class="language-julia hljs">dag = generate_DAG(proc)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Graph:
  Nodes: Total: 619, QEDFeynmanDiagrams.ComputeTask_PropagatePairs: 42, ComputableDAGs.DataTask: 334, 
         QEDFeynmanDiagrams.ComputeTask_SpinPolCumulation: 1, QEDFeynmanDiagrams.ComputeTask_Propagator: 42, QEDFeynmanDiagrams.ComputeTask_CollectPairs: 42, 
         QEDFeynmanDiagrams.ComputeTask_BaseState: 7, QEDFeynmanDiagrams.ComputeTask_CollectTriples: 1, QEDFeynmanDiagrams.ComputeTask_Triple: 81, 
         QEDFeynmanDiagrams.ComputeTask_Pair: 69
  Edges: 950
  Total Compute Effort: 0.0
  Total Data Transfer: 0.0
  Total Compute Intensity: 0.0
</code></pre><p>To continue, we will need <a href="https://github.com/ComputableDAGs/ComputableDAGs.jl"><code>ComputableDAGs.jl</code></a>. Since <code>ComputableDAGs.jl</code> uses <code>RuntimeGeneratedFunction</code>s as the return type of <a href="https://computabledags.github.io/ComputableDAGs.jl/dev/lib/internals/code_gen/#ComputableDAGs.get_compute_function-Tuple%7BDAG%2C%20Any%2C%20Machine%2C%20Module%7D"><code>ComputableDAGs.get_compute_function</code></a>, we need to initialize it in our current module.</p><pre><code class="language-julia hljs">using ComputableDAGs
using RuntimeGeneratedFunctions
RuntimeGeneratedFunctions.init(@__MODULE__)</code></pre><p>With the DAG, the process, and <code>RuntimeGeneratedFunctions</code> initalized, we can now generate the actual computable function:</p><pre><code class="language-julia hljs">func = get_compute_function(dag, proc, cpu_st(), @__MODULE__);</code></pre><p>Now we need an input for the function, which is a <a href="https://qedjl-project.github.io/QEDcore.jl/dev/#QEDcore.PhaseSpacePoint"><code>QEDcore.PhaseSpacePoint</code></a>. For now, we generate random momenta for every particle. In the future, QEDevents will be able to generate physical <code>PhaseSpacePoint</code>s.</p><pre><code class="language-julia hljs">psp = PhaseSpacePoint(
    proc,
    PerturbativeQED(),
    PhasespaceDefinition(SphericalCoordinateSystem(), ElectronRestFrame()),
    tuple((rand(SFourMomentum) for _ in 1:number_incoming_particles(proc))...),
    tuple((rand(SFourMomentum) for _ in 1:number_outgoing_particles(proc))...),
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PhaseSpacePoint:
    process: generic QED process &quot;ek -&gt; eeepp&quot;
    model: perturbative QED
    phasespace definition: spherical coordinates in electron rest frame
    incoming particles:
     -&gt; incoming electron: [0.015518614195957348, 0.7847767760594717, 0.5280919233788777, 0.31183145889705477]
     -&gt; incoming photon: [0.5594037995325966, 0.9615817482982688, 0.9246088978126191, 0.1266273386279293]
    outgoing particles:
     -&gt; outgoing electron: [0.9613346104887188, 0.5695901841529666, 0.2962720575033173, 0.7266581354102057]
     -&gt; outgoing electron: [0.8884726896538461, 0.6170338332871078, 0.8042283686320119, 0.7885477488388772]
     -&gt; outgoing electron: [0.6131968196276264, 0.046190512182082366, 0.6664486585472389, 0.055388957840193154]
     -&gt; outgoing positron: [0.4246145429413365, 0.4703963802828812, 0.7525739878520303, 0.8140030975958155]
     -&gt; outgoing positron: [0.7520494964533906, 0.15207431109409641, 0.41226723685659894, 0.6747215417724626]
</code></pre><p>Finally, we can test that the function actually runs and computes something by simply calling it on the <code>PhaseSpacePoint</code>:</p><pre><code class="language-julia hljs">func(psp)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.7579280417864616e6</code></pre><p>If we want, we can benchmark the execution speed too:</p><pre><code class="language-julia hljs">using BenchmarkTools
@benchmark func($psp)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BenchmarkTools.Trial: 10000 samples with 1 evaluation.
 Range <span class="sgr90">(</span><span class="sgr36"><span class="sgr1">min</span></span> … <span class="sgr35">max</span><span class="sgr90">):  </span><span class="sgr36"><span class="sgr1">43.111 μs</span></span> … <span class="sgr35">181.608 ms</span>  <span class="sgr90">┊</span> GC <span class="sgr90">(</span>min … max<span class="sgr90">): </span> 0.00% … 99.91%
 Time  <span class="sgr90">(</span><span class="sgr34"><span class="sgr1">median</span></span><span class="sgr90">):     </span><span class="sgr34"><span class="sgr1">48.141 μs               </span></span><span class="sgr90">┊</span> GC <span class="sgr90">(</span>median<span class="sgr90">):    </span> 0.00%
 Time  <span class="sgr90">(</span><span class="sgr32"><span class="sgr1">mean</span></span> ± <span class="sgr32">σ</span><span class="sgr90">):   </span><span class="sgr32"><span class="sgr1">79.695 μs</span></span> ± <span class="sgr32">  1.817 ms</span>  <span class="sgr90">┊</span> GC <span class="sgr90">(</span>mean ± σ<span class="sgr90">):  </span>25.24% ±  2.80%

    ██<span class="sgr34">▁</span>                          <span class="sgr32"> </span>                              
  ▂▇██<span class="sgr34">█</span>▅▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▃▃▃▃▃▄▅<span class="sgr32">▆</span>▆▅▄▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▂▂▂▂▂▂ ▃
  43.1 μs<span class="sgr90">         Histogram: frequency by time</span>          114 μs <span class="sgr1">&lt;</span>

 Memory estimate<span class="sgr90">: </span><span class="sgr33">93.92 KiB</span>, allocs estimate<span class="sgr90">: </span><span class="sgr33">831</span>.</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../manual/">« Manual</a><a class="docs-footer-nextpage" href="../compton/">Compton »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 11 September 2024 13:33">Wednesday 11 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
